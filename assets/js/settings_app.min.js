var POS=function(a){return a.module("SettingsApp",function(a,b){a.startWithParent=!1,a.onStart=function(){b.debug&&console.log("POS Settings Module started");var c=b.getCurrentRoute()||"general";new a.Controller({tab:c})}}),a}(POS||{}),POS=function(a,b,c){return a.SettingsApp.Controller=c.Controller.extend({initialize:function(b){this.settingsRegion=new c.Region({el:"#wc-pos-settings"}),this.modalRegion=new c.Region({el:"#wc-pos-modal"}),a.Components.Modal.controller=new a.Components.Modal.Controller({container:this.modalRegion}),this.settingsCollection=a.Entities.channel.request("wp_option:entities"),this.settingsCollection.add(a.bootstrap),this._showTabs(b),this._showSettings(b)},_showTabs:function(b){var c=new a.SettingsApp.Views.Tabs(b);this.listenTo(c,"settings:tab:clicked",function(b){a.navigate(b),this._showSettings({tab:b})},this)},_showSettings:function(b){var c=new a.SettingsApp.Views.Settings({collection:this.settingsCollection,model:this.settingsCollection.get(b.tab)});this.listenTo(c,"settings:form:submit",function(a){this._saveSettings(a)}),this.settingsRegion.show(c)},_saveSettings:function(a){a.save()}}),a}(POS||{},Backbone,Marionette,jQuery,_),POS=function(a,b,c,d,e){return a.SettingsApp.Views={},a.SettingsApp.Views.Tabs=c.ItemView.extend({el:"#wc-pos-settings-tabs",initialize:function(a){this.$('a[data-tab="'+a.tab+'"]').addClass("nav-tab-active")},events:{"click a":"onTabClicked"},onTabClicked:function(a){a.preventDefault();var b=d(a.target);b.hasClass("nav-tab-active")||(this.trigger("settings:tab:clicked",b.data("tab")),b.addClass("nav-tab-active").siblings("a.nav-tab-active").removeClass("nav-tab-active"))}}),a.SettingsApp.Views.Settings=c.ItemView.extend({tagName:"form",initialize:function(){this.template=e.template(d("#tmpl-wc-pos-settings-"+this.model.id).html()),this.listenTo(this.model,"request",this.saving),this.listenTo(this.model,"change:response",this.saved)},ui:{submit:'input[type="submit"]',id:'input[name="id"]'},events:{"click @ui.submit":"onSubmit","mouseenter a.wc-pos-modal":"proLoadSettings","click a.wc-pos-modal":"openModal"},behaviors:{Select2:{},Tooltip:{},Sortable:{}},onBeforeShow:function(){b.Syphon.deserialize(this,this.model.toJSON())},onBeforeDestroy:function(){this.storeState()},onSubmit:function(a){a.preventDefault(),this.storeState().save()},storeState:function(){var a=b.Syphon.serialize(this);return this.model.set(a)},saving:function(){this.ui.submit.prop("disabled",!0).next("p.response").html('<i class="spinner"></i>')},saved:function(){var a=this.model.get("response"),b="success"==a.result?"yes":"no";this.ui.submit.prop("disabled",!1).next("p.response").html('<i class="dashicons dashicons-'+b+'"></i>'+a.notice),this.model.unset("response",{silent:!0})},proLoadSettings:function(a){var b="gateway_"+d(a.target).data("gateway");if(e.isUndefined(this.collection.get(b))){var c=this.collection.add({id:b,security:this.model.get("security"),title:"Loading ..."});c.fetch()}},openModal:function(b){b.preventDefault();var c="gateway_"+d(b.target).data("gateway");new a.SettingsApp.Views.Modal({model:this.collection.get(c)})}}),a.SettingsApp.Views.Modal=c.ItemView.extend({template:e.template(d("#tmpl-wc-pos-modal").html()),behaviors:{Modal:{},Tooltip:{}},initialize:function(){this.trigger("modal:open"),this.listenTo(this.model,"change",this.render)},events:{"click .save":"save","click .close":"cancel"},onBeforeShow:function(){b.Syphon.deserialize(this,this.model.toJSON())},save:function(){var a=b.Syphon.serialize(this);return this.model.set(a)},cancel:function(){this.trigger("modal:close")}}),a}(POS||{},Backbone,Marionette,jQuery,_);
//# sourceMappingURL=maps/settings_app.map