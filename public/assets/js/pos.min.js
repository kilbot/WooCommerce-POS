!function(a){"use strict";if("undefined"==typeof pos_cart_params)return console.log("No pos_cart_params"),!1;{var b=Backbone.Model.extend({defaults:{cart_hash:"default-cart-hash",fragments:"There seems to be a problem getting the cart :("}}),c=new b,d=Backbone.Collection.extend({model:b,url:pos_cart_params.ajax_url,parse:function(a){return console.log("updating cart"),console.log(a),c.set(a),a}}),e=new d,f=Backbone.View.extend({el:a("#cart"),initialize:function(){console.log("initializing cart"),e.on("add",this.render,this),e.on("reset",this.render,this),mediator.subscribe("updateCart",function(){e.fetch({data:{action:"get_cart_fragment"},processData:!0,reset:!0})})},render:function(){console.log("rendering cart"),this.$el.html(c.get("fragments"))},events:{"click a.remove-from-cart":"removeFromCart"},removeFromCart:function(b){b.preventDefault(),console.log(a(b.currentTarget).attr("href"));var d={action:"pos_remove_item",href:a(b.currentTarget).attr("href")};a.post(pos_cart_params.ajax_url,d,function(a){return a?a.error?void console.log(a.error):(console.log(c.get("cart_hash")),c.set(a),e.reset(),void console.log(c.get("cart_hash"))):void console.log("No response from server")})}});new f}e.fetch({data:{action:"get_cart_fragment"},processData:!0,reset:!0})}(jQuery),function(a){"use strict";a("#user-actions-btn, #user-actions").hover(function(){a("#user-actions").show()},function(){a("#user-actions").hide()})}(jQuery),function(a){"use strict";if("undefined"==typeof pos_cart_params)return console.log("No pos_cart_params"),!1;var b=Backbone.PageableCollection.extend({url:pos_cart_params.ajax_url,mode:"client",state:{pageSize:5,sortKey:"updated"},queryParams:{action:"get_products",totalPages:null,totalRecords:null,sortKey:"sort",q:""},parseState:function(a){return{totalRecords:a.total_count}},parseRecords:function(a){return console.log("rendering products"),a.products}}),c=new b,d=new Backgrid.Grid({columns:[{name:"img",label:"",cell:Backgrid.Cell.extend({render:function(){return this.$el.html(this.model.get("img")),this}}),sortable:!1,editable:!1},{name:"title",label:"Product",cell:Backgrid.Cell.extend({render:function(){var b="<strong>"+this.model.get("title")+"</strong>",c="";if(this.model.has("variation_id")){var d=[];a.each(this.model.get("variation_data"),function(a,b){var c=b.key+": "+b.value;d.push(c)}),c="<br /><small>"+d.join("<br>")+"</small>"}var e=""===this.model.get("stock")?"":"<br /><small>"+this.model.get("stock")+" in stock</small>";return this.$el.html(b+c+e),this}}),sortable:!1,editable:!1},{name:"price",label:"Price",cell:Backgrid.Cell.extend({render:function(){return this.$el.html(this.model.get("price")),this}}),sortable:!1,editable:!1},{name:"add",label:"",cell:Backgrid.Cell.extend({events:{"click a.add-to-cart":"addToCart"},render:function(){var b=this.model.get("id"),c="",d="?"+a.param({"add-to-cart":this.model.get("id")});this.model.has("variation_id")&&(b=this.model.get("parent_id"),c=this.model.get("variation_id"),d="?"+a.param({"add-to-cart":b,variation_id:c}));var e='<a class="add-to-cart btn btn-circle btn-flat-action" href="'+d+'" data-id="'+b+'" data-variant_id="'+c+'"><i class="fa fa-plus"></i></a>';return this.$el.html(e),this},addToCart:function(b){b.preventDefault();var c={action:"pos_add_to_cart",id:this.model.get("id")};this.model.has("variation_id")&&(c={action:"pos_add_to_cart",id:this.model.get("parent_id"),variation_id:this.model.get("variation_id")}),a.post(pos_cart_params.ajax_url,c,function(a){return a?a.error?void console.log(a.error):void mediator.publish("updateCart"):void console.log("No response from server")})}}),sortable:!1,editable:!1}],collection:c}),e=new Backgrid.Extension.Paginator({collection:c,windowSize:5,controls:{rewind:null,fastForward:null,back:{label:'<i class="fa fa-chevron-left"></i>',title:"Previous"},forward:{label:'<i class="fa fa-chevron-right"></i>',title:"Next"}}}),f=new Backgrid.Extension.ClientSideFilter({collection:c,fields:["title"],placeholder:"Search products"});a("#products").append(f.render().$el),a("#products").append(d.render().$el),a("#products").append(e.render().$el),console.log("fetching products"),c.fetch({reset:!0})}(jQuery);
//# sourceMappingURL=pos.min.map